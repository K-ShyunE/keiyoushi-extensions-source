name: Build Korean Extensions

# 메인 브랜치에 푸시되거나, 수동으로 실행할 때 작동
on:
  push:
    branches: [ "main" ]
    paths:
      - 'src/ko/**'        # src/ko 폴더 내부가 변경될 때만 작동
      - '.github/workflows/build_korean.yml'
  workflow_dispatch:      # Actions 탭에서 버튼 눌러서 수동 실행 가능

jobs:
  build_korean:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      # 핵심 변경 사항:
      # :src:ko:assembleDebug 명령을 사용하면
      # src/ko 폴더 아래에 있는 모든 확장기능(BlackToon 포함 전체)을 빌드합니다.
      - name: Build All Korean Extensions
        run: ./gradlew :src:ko:assembleDebug

      # 빌드된 모든 APK를 찾아서 업로드합니다.
      - name: Upload APKs
        uses: actions/upload-artifact@v4
        with:
          name: korean-extensions-debug
          path: "**/*-debug.apk"
          retention-days: 1
